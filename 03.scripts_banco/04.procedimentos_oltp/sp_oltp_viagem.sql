USE Mais_Transporte

CREATE OR ALTER PROCEDURE SP_OLTP_VIAGEM (@DATA_CARGA DATETIME, @DATA_INICIAL DATETIME, @DATA_FINAL DATETIME)
AS
BEGIN
	SET NOCOUNT ON
	SET LANGUAGE BRAZILIAN

	WHILE (@DATA_INICIAL < @DATA_FINAL)
	BEGIN
		INSERT INTO TB_AUX_VIAGEM 
		SELECT @DATA_CARGA, TITULO, LOCAL_ORIGEM, LOCAL_DESTINO, VALOR_PASSAGEM, TOTAL_VAGAS, DATA_PARTIDA, DATA_CHEGADA, DESCRICAO, STATUS, ID_MOTORISTA
		FROM TB_VIAGEM

		SET @DATA_INICIAL = @DATA_INICIAL + 1
	END
END

EXEC SP_OLTP_VIAGEM '20240322', '20231120', '20231128'

SELECT * FROM TB_VIAGEM
SELECT * FROM TB_AUX_VIAGEM